(()=>{var t={n:e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["forum/app"];var r=t.n(e);function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var o="data-lb-moreformat-mounted";function a(){var t=document.querySelector('.ProseMirror[contenteditable="true"]');return t||(document.querySelector('.RichText-editor[contenteditable="true"]')||null)}function u(){return document.querySelector(".TextEditor textarea")}function i(t){var e=a();if(e)return e.focus(),document.execCommand("insertText",!1,t),!0;var r=u();if(r){var n,o,i=null!=(n=r.selectionStart)?n:r.value.length,l=null!=(o=r.selectionEnd)?o:i;return r.value=r.value.slice(0,i)+t+r.value.slice(l),r.selectionStart=r.selectionEnd=i+t.length,r.dispatchEvent(new Event("input",{bubbles:!0})),r.focus(),!0}return!1}function l(){var t=a();if(t)return t.focus(),document.execCommand("insertParagraph"),!0;var e=u();if(e){var r,n,o=null!=(r=e.selectionStart)?r:e.value.length,i=null!=(n=e.selectionEnd)?n:o;return e.value=e.value.slice(0,o)+"\n"+e.value.slice(i),e.selectionStart=e.selectionEnd=o+1,e.dispatchEvent(new Event("input",{bubbles:!0})),e.focus(),!0}return!1}function c(t,e){try{var n=r().translator.trans(t);return n&&n!==t?n:e}catch(t){return e}}var s=[{key:"blank-1",i18nKey:"lady-byron-more-format.forum.blank_paragraph",fallback:"空白段落",icon:"fas fa-paragraph",run:function(){return function(t){void 0===t&&(t=1);for(var e=0;e<t;e++)l(),i(" "),l()}(1)}},{key:"indent",i18nKey:"lady-byron-more-format.forum.indent",fallback:"段首缩进",icon:"fas fa-indent",run:function(){i("　　")}}];function f(t){var e,r=t;if(!r.getAttribute(o)){r.setAttribute(o,"1");for(var a,u=null!=(e=r.querySelector(".ButtonGroup"))?e:r,i=function(){var t=a.value,e=document.createElement("button");e.type="button",e.className="Button Button--icon",e.innerHTML='<i class="'+t.icon+'"></i>',function(t,e,r){var n=c(e,r);t.setAttribute("title",n),t.setAttribute("aria-label",n),requestAnimationFrame(function(){var n=c(e,r);t.setAttribute("title",n),t.setAttribute("aria-label",n)}),setTimeout(function(){var n=c(e,r);t.setAttribute("title",n),t.setAttribute("aria-label",n)},300)}(e,t.i18nKey,t.fallback),e.addEventListener("click",function(e){e.preventDefault(),t.run()}),u.appendChild(e)},l=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(s);!(a=l()).done;)i()}}r().initializers.add("lady-byron/more-format",function(){var t,e,n=function(){return Array.from(document.querySelectorAll(".RichTextEditor-toolbar, .TextEditor-controls")).forEach(f)};n(),new MutationObserver(n).observe(document.body,{childList:!0,subtree:!0}),null==(t=r().history)||null==t.on||t.on("push",n),null==(e=r().history)||null==e.on||e.on("pop",n)})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map